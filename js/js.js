$(function(){
    // 轮播图
    var swiper = new Swiper('#swiper1', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }

        });

    // var oBox = document.getElementById('swiper-container');
    
    // oBox.onmouseover = function(){//鼠标经过停止
    //     swiper.autoplay.stop();
    // }
    
    // oBox.onmouseout = function(){//鼠标经过离开
    //     swiper.autoplay.start();
    // }

    var swiper = new Swiper('#swiper2', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper3', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper4', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper5', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper6', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper7', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper8', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper9', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper10', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper11', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper12', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });
    var swiper = new Swiper('#swiper13', {
            pagination: '.swiper-pagination',
            paginationClickable: true,
            nextButton: '.swiper-button-next',
            prevButton: '.swiper-button-prev',
            parallax: true,
            speed: 600,
            slidesPerView: 1,
            loop: true,
            autoplay: 2500,
            mousewheel:true,
            autoplayDisableOnInteraction: false,
            effect : 'fade',
            fade:{
                crossFade: false,
            }
        });

    // 首页列表页渲染
    var lim_goods = document.getElementById("lim_goods");
    function init(){
        ajax2({
            type : 'get',
            url : 'api/src.php',
            success : str =>{
                // console.log(str);
                var arr = JSON.parse(str);
                var res = arr.map(function(item){
                    return`<li data-id="${item.id}">
                                <img src="${item.imgurl}" />
                                <p>${item.name}</p>
                                <span class="sp1">￥${item.oldPrice}</span>
                                <span class="sp2">
                                    <del>￥${item.price}</del>
                                </span>
                            </li>`
                }).join("");
                lim_goods.innerHTML = res;
            }
        })
    }
    init();

    // 左侧楼层跳跃
    var box = document.getElementById('box');
    var lous = document.getElementsByClassName("floor");//楼层
    var sideNav = document.getElementById('side-nav');
    var btns = sideNav.getElementsByTagName('li');//按钮
    
    // window.onscroll = function(){
        
    // }
        
    // 点击按钮可以跳转到对应楼层
    for(var i = 0; i < btns.length; i++) {
        //绑定索引
        btns[i].index = i;
        btns[i].onclick = function() {
        // console.log(this.index);
            //排他
            for(var j = 0; j < btns.length; j++) {
                btns[j].className = '';
            }
            this.className = 'red';
            var ih = lous[this.index].offsetTop;
            window.scrollTo(0,ih);
        }
    }

    //3.滚动滑轮，到达临界点的时候，按钮跟着高亮显示
    var scrollTop = window.scrollY;//滚动距离
    for(var i = 0; i < lous.length; i++) {
        if(scrollTop >= lous[i].offsetTop) {
            // console.log(i);
            //排他
            for(var j = 0; j < btns.length; j++) {
                btns[j].className = '';
            }
            btns[i].className = 'red';
        }
    }
     

    // 右侧栏显示与隐藏
    var rit = document.getElementById("rit");
    window.onscroll = function(){
        var y = window.scrollY;
        // console.log(y);
        if(y >= 350){
            rit.style.display = "block";
            // rit.style.display = "transition:all 1s";
        }else if(y < 350){
            rit.style.display = "none";
        }
        // var y = window.scrollY;
        // console.log(y);
        if(y >= 710){
            sideNav.style.display = "block";
        }else if(y < 710){
            sideNav.style.display = "none";
        }
    }

    // TOP用户名渲染
    var top_name = document.getElementById("top_name");
    var top_out = document.getElementById("top_out");
    var top_out2 = document.getElementById("top_out2");
    var name = getCookie("username");

    if(getCookie("username")){
        top_name.innerHTML = name;
        top_name.style.marginRight = "640px" ;
        top_out.style.display = "none";
        top_out2.style.display = "block";
        top_out2.onclick = () =>{
            removeCookie("username");
            location.href = "html/log.html";
        }
    }
    
    // 点击跳转购物车页
    $("#index_cart").click(function(){
        location.href = "html/cart.html";
    })
    $("#index_cart2").click(function(){
        location.href = "html/cart.html";
    })
})